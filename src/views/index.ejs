<%- include('includes/head'); %>
  <%- include('includes/nav') %>

    <main class="main">
      <h1>Produtos Registrados: <span style="font-style: italic;">145</span></h1>
      <section class="sidebar-header">

        <form class="search-box" action="/products/search" method="post">
          <input type="hidden" name="_csrf" value=<%= csrfToken %>>
          <input type="text" name="searchProduct" class="search-text" id="" placeholder="Pesquisar...">
          <button class="search-btn" type="submit">
            <i class="material-symbols-outlined loupe-blue">search</i>
          </button>
        </form>
        <div class="filter_box">
          <i class="material-symbols-outlined">filter_list</i>
          <span>Filtros</span>
        </div>
        <a href="/product/register"><i class="material-symbols-outlined" id="add-product">add_shopping_cart</i></a>

      </section>

      <section class="products-main-info">

        <article>
          <aside class="values-products-main">R$ 70.216,00</aside>
          <aside class="products-main-details">Valor em estoque</aside>
        </article>
        <article>
          <aside class="values-products-main">R$ 25.958,00</aside>
          <aside class="products-main-details">Custo do estoque</aside>
        </article>
        <article>
          <aside class="values-products-main">R$ 44.258,00</aside>
          <aside class="products-main-details">Previsão de lucro</aside>
        </article>
        <article>
          <aside class="values-products-main">8</aside>
          <aside class="products-main-details">Em falta</aside>
        </article>
        <article>
          <aside class="values-products-main">2</aside>
          <aside class="products-main-details">Sem estoque</aside>
        </article>
        <article>
          <aside class="values-products-main">145</aside>
          <aside class="products-main-details">Qtde em estoque</aside>
        </article>

      </section>

      <section class="table-products-main">
        <!--for demo wrap-->
        <h1 class="text-center my-3">Tabela de produtos</h1>

        <%- include('includes/messages') %>

          <% if (products.length> 0) { %>
            <div class="table-responsive">
              <table class="table table-dark table-striped table-hover align-middle">
                <thead class="products-thead-index">
                  <tr>
                    <th class="text-nowrap">ID<i class="material-symbols-outlined">swap_vert</i></th>
                    <th class="text-nowrap">Produto<i class="material-symbols-outlined">swap_vert</i></th>
                    <th class="text-nowrap">Categoria<i class="material-symbols-outlined">swap_vert</i></th>
                    <th class="text-nowrap">Estoque<i class="material-symbols-outlined">swap_vert</i></th>
                    <th class="text-nowrap">Preço<i class="material-symbols-outlined">swap_vert</i></th>
                    <th class="text-nowrap">Descrição<i class="material-symbols-outlined">swap_vert</i></th>
                    <th></th>
                    <!-- <td><span>Catalógo</span> <i class="material-symbols-outlined">swap_vert</i></td> -->
                  </tr>
                </thead>
                <tbody class="products-tbody-index position-relative">
                  <!-- Esse contacts é por conta que no home controller onde estou pegando os contatos na BD, estou renderizando o obj {contacts} -->
                  <% products.forEach(prod=> { %>
                    <tr>
                      <td>
                        <% prod._id %><i class="material-symbols-outlined" title="Copiar ID">content_copy</i>
                          <%#= prod._id %>
                      </td>
                      <td>
                        <%= prod.nameProd %>
                      </td>
                      <td>
                        <%= prod.category %>
                      </td>
                      <td class="">
                        <form method="post" action="/product/quantityProduct/<%=prod._id%>">
                          <input type="hidden" name="_csrf" value=<%= csrfToken %>>
                          <input class="w-25" type="number" min="0" max="100" step="1" value="<%= prod.quantity %>" id="my-input" readonly>
                          <button type="submit" value="-1" class="sinals" name="btnProductQtd"> - </button>
                          <button type="submit" value="1" class="sinals" name="btnProductQtd"> + </button>
                          <!-- 
                        <a href="/product/stockAdd/<%#=prod._id%>" id="increment" value="1" class="sinals" name="productQtdAdd" onclick="stepper(this)">+</a>
                        <a href="/product/stockAdd/<%#=prod._id%>" id="decrement" value="1" class="sinals" name="productQtdSub" onclick="stepper(this)">-</a>
                           -->
                        </form>
                    </td>
                      <!-- <td>1<a href="/product/<%#=prod._id%>"><span><i class="material-symbols-outlined">add_circle</i></span></a></td> -->
                      <td><span>R$ </span>
                        <%= prod.price %>
                      </td>
                      <td class="item-description-index overflow-hidden text-nowrap"
                        style="max-width: 200px;">
                        <%= prod.description %>
                      </td>
                      <td class="text-end p-0 pe-1">
                        <a href="/product/<%=prod._id%>"><i class="material-symbols-outlined"
                            title="Editar">edit</i></a>
                        <a href="/product/delete/<%=prod._id%>"><i class="material-symbols-outlined"
                            title="Deletar">delete</i></a>
                      </td>
                    </tr>
                    <% }); %>
                </tbody>
              </table>
            </div>
            <% } else {%>
              <div class="alert alert-primary">
                <p class="text-center lead"><strong>Nenhum produto foi cadastrado</strong></p>
              </div>
              <% } %>
                </div>
                <div class="col-lg-2"></div>


                <!-- Add product -->
                <!-- 
    <%# if (products.length > 0) { %>
        <div class="tbl-content">
            <table cellpadding="0" cellspacing="0" border="1">
                <thead class="thead-main-products">
                    <tr>
                        <td><span>ID</span> <i class="material-symbols-outlined">swap_vert</i>
                        </td>
                        <td><span>Produto</span><i class="material-symbols-outlined">swap_vert</i></td>
                        <td><span>Categoria</span><i class="material-symbols-outlined">swap_vert</i></td>
                        <td><span>Estoque</span><i class="material-symbols-outlined">swap_vert</i></td>
                        <td><span>Preço</span><i class="material-symbols-outlined">swap_vert</i></td>
                        <td><span>Descrição</span></td>
                        <td></td>
                    </tr>
                </thead>
                <tbody class="tbody-products-index">
                  <%# products.forEach(prod => { %>
                      <tr>
                          <td><i class="material-symbols-outlined">content_copy</i><%#= prod._id %></td>
                          <td><%#= prod.nameProd %></td>
                          <td><%#= prod.category %></td>
                          <td id="item-price-index">
                              <a href=""><i id="icon-add" class="material-symbols-outlined">add</i></a>
                              <a href=""><i class="material-symbols-outlined">remove</i></a>
                          </td>
                          <td><span>R$ </span><%#= prod.price %></td>
                          <td><%#= prod.description %></td>
                          <td>
                              <a href="/product/<%#=prod._id%>"><i class="material-symbols-outlined">edit</i></a>
                              <a href="/product/delete/<%#=prod._id%>"><i class="material-symbols-outlined">delete</i></a>
                          </td>
                      </tr>
                  <%# }) %>
                </tbody>
            </table>
        </div>
        <%# } else { %>
          <p style="text-align: center;">Nenhum produto foi cadastrado</p>
        <%# } %>
 -->
      </section>

    </main>

    <%- include('includes/footer'); %>